@Component
script ExtendToggleGachaMenu extends ToggleAction

	property Entity GachaButtonGrid = nil

	property number panelIndex = 0

	property Entity PickUpCharter = nil

	method void ExecuteOnLogic(Toggle sender)
		__base:ToggleGroupActivate()
		
		local gachaUnitInfoPanel = _EntityService:GetEntityByPath("/ui/GachaUI/BackgroundUI/GachaUnitInfoPanel")
		
		if self.GachaButtonGrid then
			self.GachaButtonGrid.Enable = true
			self:SetGachaKey(self.panelIndex)
		end
		
		if self.PickUpCharter then
			self.PickUpCharter.Enable = true
		end
		
		self:SetPickUpCharter()
		
		gachaUnitInfoPanel.Visible = false
	end

	method void ExecuteOffLogic(Toggle sender)
		if self.GachaButtonGrid then
			self.GachaButtonGrid.Enable = false
		end
		
		if self.PickUpCharter then
			self.PickUpCharter.Enable = false
		end
	end

	method void SetGachaKey(integer key)
		if key == 1 then
			_GachaManager.GachaKey = _GachaManager.PickUpSummonKey
		elseif key == 2 then
			_GachaManager.GachaKey = _GachaManager.PickUp_2_SummonKey
		elseif key == 3 then
			_GachaManager.GachaKey = _GachaManager.NormalSummonKey
		end
	end

	method void SetPickUpCharter()
		local youtubePlayer = _EntityService:GetEntityByPath("/ui/GachaUI/BackgroundUI/DisplayBoard/YoutubePlayerGUI")
		local board = _EntityService:GetEntityByPath("/ui/GachaUI/BackgroundUI/DisplayBoard")
		local infoButton = _EntityService:GetEntityByPath("/ui/GachaUI/BackgroundUI/InfoButton")
		local summonCount = _EntityService:GetEntityByPath("/ui/GachaUI/BackgroundUI/GachaCountRoot")
		
		summonCount.GachaCount:SetSummonCount()
		
		if self.panelIndex == 3 then
			youtubePlayer.YoutubePlayerGUIComponent:Pause()
			board.Enable = false
			infoButton.Enable = false
		else
			-- 픽업 캐릭터로 세팅
			self.PickUpCharter.Enable = true
			infoButton.Enable = true
			
			local setting = _SummonService:GET_SETTING(_GachaManager.GachaKey)
			if setting.video ~= nil or setting.video ~= "-" then
				local newUrls = {}
				newUrls[#newUrls + 1] = setting.video
				youtubePlayer.YoutubePlayerGUIComponent.Urls = newUrls
			end
			board.Enable = true
			youtubePlayer.YoutubePlayerGUIComponent:Play()
			infoButton.GachaUnitInfoButton.unitID = setting.pickup_char_id
		end
	end

end